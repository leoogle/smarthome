<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button></ion-back-button>
    </ion-buttons>
    <ion-title>Clima y Temperatura</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="clima-content">
  <div class="clima-container">
    <h2 class="page-title">Control de Clima</h2>

    <div *ngIf="dispositivos.length === 0" class="empty-state">
      <ion-icon name="thermometer-outline" class="empty-icon"></ion-icon>
      <p>No hay dispositivos de clima conectados</p>
    </div>

    <ion-list *ngIf="dispositivos.length > 0">
      <ion-item 
        *ngFor="let dispositivo of dispositivos" 
        class="dispositivo-item">
        <div class="device-content">
          <div class="device-header">
            <ion-icon [name]="dispositivo.icon" class="device-icon"></ion-icon>
            <div class="device-info">
              <h2>{{ dispositivo.name }}</h2>
              <p>{{ dispositivo.location }}</p>
              <p [class.connected]="dispositivo.status === 'connected'" 
                 [class.disconnected]="dispositivo.status === 'disconnected'">
                {{ dispositivo.status === 'connected' ? 'Conectado' : 'Desconectado' }}
              </p>
            </div>
            <ion-toggle 
              *ngIf="dispositivo.type === 'ac' || dispositivo.type === 'fan'"
              [checked]="dispositivo.value?.on"
              (ionChange)="toggleDevice(dispositivo)">
            </ion-toggle>
          </div>
          
          <!-- Temperatura -->
          <div *ngIf="dispositivo.value?.temperature !== undefined" class="control-section">
            <ion-label class="control-label">
              Temperatura: {{ dispositivo.value?.temperature }}°C
            </ion-label>
            <ion-range 
              *ngIf="dispositivo.type === 'thermostat' || dispositivo.type === 'ac'"
              min="16" 
              max="30" 
              step="1"
              [value]="dispositivo.value?.temperature"
              (ionChange)="adjustTemperature(dispositivo, $event)">
            </ion-range>
            <div *ngIf="dispositivo.type === 'temperature-sensor'" class="temperature-display">
              <span class="temperature-value">{{ dispositivo.value?.temperature }}°C</span>
            </div>
          </div>

          <!-- Humedad -->
          <div *ngIf="dispositivo.value?.humidity !== undefined" class="control-section">
            <ion-label class="control-label">
              Humedad: {{ dispositivo.value?.humidity }}%
            </ion-label>
          </div>

          <!-- Velocidad del ventilador -->
          <div *ngIf="dispositivo.type === 'fan' && dispositivo.value?.on" class="control-section">
            <ion-label class="control-label">
              Velocidad: {{ dispositivo.value?.speed }}/5
            </ion-label>
            <ion-range 
              min="1" 
              max="5" 
              step="1"
              [value]="dispositivo.value?.speed"
              (ionChange)="adjustFanSpeed(dispositivo, $event)">
            </ion-range>
          </div>
        </div>
      </ion-item>
    </ion-list>
  </div>
</ion-content>

