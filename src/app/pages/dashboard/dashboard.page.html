<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>{{ userName }}</ion-title>
    <ion-buttons slot="end">
      <ion-menu-button menuId="main-menu"></ion-menu-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="dashboard-content">
  <div class="dashboard-container">
    <!-- Opciones circulares -->
    <div class="options-container">
      <div 
        class="option-circle" 
        [class.active]="selectedOption === 1"
        (click)="selectOption(1)">
        <ion-icon name="star" [class.filled]="selectedOption === 1"></ion-icon>
        <span>OPCIÓN 1</span>
      </div>
      <div 
        class="option-circle" 
        [class.active]="selectedOption === 2"
        (click)="selectOption(2)">
        <ion-icon name="star" [class.filled]="selectedOption === 2"></ion-icon>
        <span>OPCIÓN 2</span>
      </div>
      <div 
        class="option-circle" 
        [class.active]="selectedOption === 3"
        (click)="selectOption(3)">
        <ion-icon name="star" [class.filled]="selectedOption === 3"></ion-icon>
        <span>OPCIÓN 3</span>
      </div>
    </div>

    <!-- Descripción -->
    <div class="description">
      <p>En esta app podrás acceder a las diferentes características para el control tecnológico de tu hogar</p>
    </div>

    <!-- Métricas -->
    <div class="metrics-section">
      <h2 class="section-title">Métricas de Consumo</h2>
      
      <div class="metrics-grid">
        <!-- Consumo de Agua -->
        <div class="metric-card water-card">
          <div class="metric-header">
            <ion-icon name="water" class="metric-icon"></ion-icon>
            <h3>Agua Potable</h3>
          </div>
          <div class="metric-value">
            <span class="value">{{ currentWater }}</span>
            <span class="unit">litros</span>
          </div>
          <div class="metric-footer">
            <span class="average">Promedio: {{ averageWater }} L/día</span>
          </div>
        </div>

        <!-- Consumo de Electricidad -->
        <div class="metric-card electricity-card">
          <div class="metric-header">
            <ion-icon name="flash" class="metric-icon"></ion-icon>
            <h3>Electricidad</h3>
          </div>
          <div class="metric-value">
            <span class="value">{{ currentElectricity }}</span>
            <span class="unit">kWh</span>
          </div>
          <div class="metric-footer">
            <span class="average">Promedio: {{ averageElectricity }} kWh/día</span>
          </div>
        </div>
      </div>

      <!-- Estadísticas de Dispositivos -->
      <div class="device-stats-card">
        <div class="stats-header">
          <ion-icon name="hardware-chip" class="stats-icon"></ion-icon>
          <h3>Dispositivos</h3>
        </div>
        <div class="stats-content">
          <div class="stat-item">
            <span class="stat-label">Total:</span>
            <span class="stat-value">{{ totalDevices }}</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Conectados:</span>
            <span class="stat-value connected">{{ connectedDevices }}</span>
          </div>
        </div>
      </div>

      <!-- Consumo por Dispositivo -->
      <div class="device-consumption-section" *ngIf="deviceConsumptions.length > 0">
        <div class="section-header">
          <h3>Consumo por Dispositivo (7 días)</h3>
          <ion-button fill="clear" size="small" (click)="goToMetrics()">
            Ver más
            <ion-icon name="chevron-forward" slot="end"></ion-icon>
          </ion-button>
        </div>
        <ion-list>
          <ion-item 
            *ngFor="let device of deviceConsumptions.slice(0, 5)" 
            class="consumption-item">
            <ion-icon name="flash-outline" slot="start" class="consumption-icon"></ion-icon>
            <ion-label>
              <h3>{{ device.deviceName }}</h3>
              <p>{{ device.consumption }} kWh ({{ device.percentage }}%)</p>
            </ion-label>
          </ion-item>
        </ion-list>
      </div>
    </div>

    <!-- Servicios -->
    <div class="servicios-section">
      <h2 class="servicios-title">Servicios</h2>
      <ion-list>
        <ion-item 
          *ngFor="let servicio of servicios" 
          class="servicio-item"
          (click)="navigateToService(servicio.route)">
          <ion-icon [name]="servicio.icon" slot="start" class="servicio-icon"></ion-icon>
          <ion-label>{{ servicio.name }}</ion-label>
          <ion-icon name="arrow-up" slot="end" class="arrow-icon"></ion-icon>
        </ion-item>
      </ion-list>
    </div>
  </div>

  <!-- Menú lateral -->
  <ion-menu side="end" menuId="main-menu">
    <ion-header>
      <ion-toolbar>
        <ion-title>Menú</ion-title>
      </ion-toolbar>
    </ion-header>
    <ion-content>
      <ion-list>
        <ion-item button (click)="goToProfile(); menuController.close()">
          <ion-icon name="person" slot="start"></ion-icon>
          <ion-label>Perfil de Usuario</ion-label>
        </ion-item>
        <ion-item button (click)="goToDevices(); menuController.close()">
          <ion-icon name="hardware-chip" slot="start"></ion-icon>
          <ion-label>Dispositivos</ion-label>
        </ion-item>
        <ion-item button (click)="logout(); menuController.close()">
          <ion-icon name="log-out" slot="start"></ion-icon>
          <ion-label>Cerrar Sesión</ion-label>
        </ion-item>
      </ion-list>
    </ion-content>
  </ion-menu>
</ion-content>

